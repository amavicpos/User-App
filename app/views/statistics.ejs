<% layout('layouts/boilerplate') %>
<div class="col-md-8 m-auto pt-4">
    <div class="row">
        <div class="col-md-8 m-auto pt-4">
            <p>Number of teams: <%= teams.length ? teams.length : 0 %></p>
            <p>Number of users: <%= users.length ? users.length : 0 %></p>
            <% if (teams.length) { %>
                <p>Number of users in each team:</p>
                <ul>
                    <% teams.forEach(team => { %>
                        <% if (team.users.length==1) { %>
                            <li><%= team.name %>: <%= team.users.length %> user</li>
                        <% } else { %>
                            <li><%= team.name %>: <%= team.users.length %> users</li>
                        <% } %>
                    <% }) %>
                </ul>
            <% } %>
            <% if (Object.keys(teams).length > 0) { %>
                <div class="container">
                    <canvas id="barChart"></canvas>
                </div>
            <% } %>
        </div>
    </div>
    <div class="row d-flex justify-content-center">
        <button class="btn" id="back" style="background-color: goldenrod; color: white">Back</button>
    </div>
</div>

<script>
    let btnBack = document.querySelector('#back');

    btnBack.addEventListener('click', () => {
        window.history.back()
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    var data = {
        labels: <%- JSON.stringify(labelsChart); %>,
        datasets: [{
            label: "Users",
            data: <%- JSON.stringify(dataChart); %>,
            backgroundColor: 'rgba(75, 192, 192, 0.6)',
            borderColor: 'rgba(75, 192, 192, 1)',
            borderWidth: 1
        }]
    };

var options = {
    responsive: true,
    maintainAspectRatio: false,
    scales: {
        yAxes: [{
            ticks: {
                beginAtZero: true
            }
        }]
    },
    plugins: {
        title: {
            display: true,
            text: 'Number of users by team'
        }
    }
};

var ctx = document.getElementById("barChart").getContext('2d');

var barChart = new Chart(ctx, {
    type: 'bar',
    data: data,
    options: options
});
</script>
