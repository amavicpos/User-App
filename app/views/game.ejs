<% layout('layouts/boilerplate') %>
<div class="container">
    <div class="col-md-8 m-auto pt-4">
        <div class="row">
            <h3>Guessing game</h3>
        </div>
        <br>
        <% if (Object.keys(teams).length > 0) { %>
            <p>Guess <%= user.name %>'s <%= question %>:</p>
            <div class="row">
                <div class="col-8">
                    <% if (question == 'team') { %>
                        <input class="form-control" id="guess" onkeypress="checkEnter(event, '<%= question %>', '<%= user[question].name %>')" />
                    <% } else { %>
                        <input class="form-control" id="guess" onkeypress="checkEnter(event, '<%= question %>', '<%= user[question] %>')" />
                    <% } %>
                    </div>
                <div class="col-4">
                    <% if (question == 'team') { %>
                        <button class="btn" onclick="checkGuess('<%= question %>', '<%= user[question].name %>')" style="background-color: goldenrod; color: white">Submit guess</button>
                    <% } else { %>
                        <button class="btn" onclick="checkGuess('<%= question %>', '<%= user[question] %>')" style="background-color: goldenrod; color: white">Submit guess</button>
                    <% } %>
                </div>
            </div>
            <br>
            <p id="message" style="text-align: center"></p>
        <% } else { %>
            <div class="text-center"><strong>No users.</strong></div>
        <% } %>

    </div>
</div>

<script>
    function checkEnter(event, question, correct) {
      if (event.keyCode === 13) {
        checkGuess(question, correct);
      }
    }

    function checkGuess(question, correct) {
        const guess = document.getElementById('guess').value;
        if (guess === correct) {
            document.getElementById('message').textContent = 'Congratulations! You guessed.';
            document.getElementById('message').style.color = 'green';
            document.getElementById('message').className = 'alert alert-success';
        } else {
            document.getElementById('message').textContent = `Not this time... The correct answer was '${correct}'`;
            document.getElementById('message').style.color = 'red';
            document.getElementById('message').className = 'alert alert-danger';
        }
        document.getElementById('message').style.className = 'text-center';
        setTimeout(() => {
            location.reload();
        }, 5000);
    }
</script>
